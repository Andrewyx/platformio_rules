
<!---
Documentation generated by Skydoc
-->
<h1>PlatformIO Rules.</h1>


<nav class="toc">
  <h2><a href="#overview">Overview</a></h2>
  <h2>Rules</h2>
  <ul>
    <li><a href="#platformio_library">platformio_library</a></li>
    <li><a href="#platformio_project">platformio_project</a></li>
  </ul>
</nav>
<hr>

<a name="overview"></a>
## Overview

These are Bazel Skylark rules for building and uploading
[Arduino](https://www.arduino.cc/) programs using the
[PlatformIO](http://platformio.org/) build system.

<a name="platformio_library"></a>
## platformio_library

<pre>
platformio_library(<a href="#platformio_library.name">name</a>, <a href="#platformio_library.deps">deps</a>, <a href="#platformio_library.src">src</a>, <a href="#platformio_library.add_hdrs">add_hdrs</a>, <a href="#platformio_library.add_srcs">add_srcs</a>, <a href="#platformio_library.hdr">hdr</a>)
</pre>

Defines a C++ library that can be imported in an PlatformIO project.

The PlatformIO build system requires a set project directory structure. All
libraries must be under the lib directory. Furthermore all libraries can only
consist of a single header and a single source file. The name of the library
must match the names of the header file, the source file and the subdirectory
under the lib directory.

If you have a C++ library with files my_lib.h and my_lib.cc, using this rule:
```
platformio_library(
    # Start with an uppercase letter to keep the Arduino naming style.
    name = "My_lib",
    hdr = "my_lib.h",
    src = "my_lib.cc",
)
```

Will generate a zip file containing the following structure:
```
lib/
  My_lib/
    My_lib.h
    My_lib.cpp
```

In the Arduino code, you should include this as follows. The PLATFORMIO_BUILD
will be set when the library is built by the PlatformIO build system.
```
#ifdef PLATFORMIO_BUILD
#include <My_lib.h>  // This is how PlatformIO sees and includes the library.
#else
#include "actual/path/to/my_lib.h" // This is for native C++.
#endif
```


<a name="platformio_library_outputs"></a>
### Outputs


<table class="params-table">
  <colgroup>
    <col class="col-param" />
    <col class="col-description" />
  </colgroup>
  <tbody>
    <tr>
      <td><code>%{name}.zip</code></td>
      <td>
        <p>A single zip file containing the C++ library in the directory structure
expected by PlatformIO.</p>
      </td>
    </tr>
  </tbody>
</table>

<a name="platformio_library_args"></a>
### Attributes


<table class="params-table">
  <colgroup>
    <col class="col-param" />
    <col class="col-description" />
  </colgroup>
  <tbody>
    <tr id="platformio_library.name">
      <td><code>name</code></td>
      <td>
        <p><code><a href="https://bazel.build/docs/build-ref.html#name">Name</a>; Required</code></p>
        <p>A string, the unique name for this rule. Start with an uppercase letter
and use underscores between words.</p>
      </td>
    </tr>
    <tr id="platformio_library.deps">
      <td><code>deps</code></td>
      <td>
        <p><code>List of <a href="https://bazel.build/docs/build-ref.html#labels">labels</a>; Optional; Default is []</code></p>
        <p>A list of Bazel targets, other platformio_library targets that this one
depends on.</p>
      </td>
    </tr>
    <tr id="platformio_library.src">
      <td><code>src</code></td>
      <td>
        <p><code><a href="https://bazel.build/docs/build-ref.html#labels">Label</a>; Optional</code></p>
        <p>A string, the name of the C++ source file. This is optional.</p>
      </td>
    </tr>
    <tr id="platformio_library.add_hdrs">
      <td><code>add_hdrs</code></td>
      <td>
        <p><code>List of <a href="https://bazel.build/docs/build-ref.html#labels">labels</a>; Optional; Default is []</code></p>
        <p>A list of labels, additional header files to include in the
resulting zip file.</p>
      </td>
    </tr>
    <tr id="platformio_library.add_srcs">
      <td><code>add_srcs</code></td>
      <td>
        <p><code>List of <a href="https://bazel.build/docs/build-ref.html#labels">labels</a>; Optional; Default is []</code></p>
        <p>A list of labels, additional source files to include in the
resulting zip file.</p>
      </td>
    </tr>
    <tr id="platformio_library.hdr">
      <td><code>hdr</code></td>
      <td>
        <p><code><a href="https://bazel.build/docs/build-ref.html#labels">Label</a>; Required</code></p>
        <p>A string, the name of the C++ header file. This is mandatory.</p>
      </td>
    </tr>
  </tbody>
</table>
<a name="platformio_project"></a>
## platformio_project

<pre>
platformio_project(<a href="#platformio_project.name">name</a>, <a href="#platformio_project.deps">deps</a>, <a href="#platformio_project.src">src</a>, <a href="#platformio_project.board">board</a>, <a href="#platformio_project.environment_kwargs">environment_kwargs</a>, <a href="#platformio_project.framework">framework</a>, <a href="#platformio_project.platform">platform</a>)
</pre>

Defines a project that will be built and uploaded using PlatformIO.

Creates, configures and runs a PlatformIO project. This is equivalent to running:
```
platformio run
```

This rule is executable and when executed, it will upload the compiled firmware
to the connected Arduino device. This is equivalent to running:
platformio run -t upload


<a name="platformio_project_outputs"></a>
### Outputs


<table class="params-table">
  <colgroup>
    <col class="col-param" />
    <col class="col-description" />
  </colgroup>
  <tbody>
    <tr>
      <td><code>.pioenvs/%{board}/firmware.elf</code></td>
      <td>
        <p>The compiled version of the Arduino firmware for the specified
board.</p>
      </td>
    </tr>
    <tr>
      <td><code>src/main.cpp</code></td>
      <td>
        <p>The C++ source file containing the Arduino setup() and loop()
functions renamed according to PlatformIO needs.</p>
      </td>
    </tr>
    <tr>
      <td><code>platformio.ini</code></td>
      <td>
        <p>The project configuration file for PlatformIO.</p>
      </td>
    </tr>
    <tr>
      <td><code>.pioenvs/%{board}/firmware.hex</code></td>
      <td>
        <p>The firmware in the hexadecimal format ready for upload.</p>
      </td>
    </tr>
  </tbody>
</table>

<a name="platformio_project_args"></a>
### Attributes


<table class="params-table">
  <colgroup>
    <col class="col-param" />
    <col class="col-description" />
  </colgroup>
  <tbody>
    <tr id="platformio_project.name">
      <td><code>name</code></td>
      <td>
        <p><code><a href="https://bazel.build/docs/build-ref.html#name">Name</a>; Required</code></p>
        <p>A string, the unique name for this rule.</p>
      </td>
    </tr>
    <tr id="platformio_project.deps">
      <td><code>deps</code></td>
      <td>
        <p><code>List of <a href="https://bazel.build/docs/build-ref.html#labels">labels</a>; Optional; Default is []</code></p>
        <p>A list of Bazel targets, the platformio_library targets that this one
depends on.</p>
      </td>
    </tr>
    <tr id="platformio_project.src">
      <td><code>src</code></td>
      <td>
        <p><code><a href="https://bazel.build/docs/build-ref.html#labels">Label</a>; Required</code></p>
        <p>A string, the name of the C++ source file, the main file for the project
that contains the Arduino setup() and loop() functions. This is mandatory.</p>
      </td>
    </tr>
    <tr id="platformio_project.board">
      <td><code>board</code></td>
      <td>
        <p><code>String; Required</code></p>
        <p>A string, name of the Arduino board to build this project for. You can
find the supported boards in the
<a href="http://platformio.org/boards">PlatformIO Embedded Boards Explorer</a>. This is
mandatory.</p>
      </td>
    </tr>
    <tr id="platformio_project.environment_kwargs">
      <td><code>environment_kwargs</code></td>
      <td>
        <p><code>Dictionary mapping strings to string; Optional; Default is {}</code></p>
        <p>A dictionary of strings to strings, any provided keys and
values will directly appear in the generated platformio.ini file under the</p>
      </td>
    </tr>
    <tr id="platformio_project.framework">
      <td><code>framework</code></td>
      <td>
        <p><code>String; Optional; Default is 'arduino'</code></p>
        <p>A string, the name of the
[framework](</p>
      </td>
    </tr>
    <tr id="platformio_project.platform">
      <td><code>platform</code></td>
      <td>
        <p><code>String; Optional; Default is 'atmelavr'</code></p>
        <p>A string, the name of the
[development platform](</p>
      </td>
    </tr>
  </tbody>
</table>
